# 게스트 참석자 기능 추가 보고서

## 변경 요약
참석자에 비회원 게스트를 추가할 수 있는 기능 구현. 게스트를 특정 멤버와 같은 카트에 배정하는 옵션 포함. 카트배 밸런스 기준을 목표타수 기반으로 변경.

## DB 변경 (Supabase SQL Editor에서 실행 필요)
```sql
ALTER TABLE members ADD COLUMN is_guest boolean NOT NULL DEFAULT false;
```

## 변경 파일
- `src/App.jsx`

## 변경 상세

### 1. 데이터 레이어
| 위치 | 변경 내용 |
|------|----------|
| `fetchAll()` members 매핑 | `isGuest: m.is_guest` 필드 추가 |
| `db.createGuestMember()` | 게스트 멤버 생성 함수 추가 (is_guest=true, active=false) |

### 2. 게스트 필터링 (정회원 뷰에서 게스트 제외)
| 컴포넌트 | 변경 |
|----------|------|
| `standings` useMemo | `!m.isGuest` 필터 추가 |
| `attendance` useMemo | `!m.isGuest` 필터 추가 |
| `Attendance` 컴포넌트 | activeMembers에서 게스트 제외 |
| `Dues` 컴포넌트 | activeMembers에서 게스트 제외 |
| `MembersMgr` 컴포넌트 | 멤버 목록에서 게스트 제외 |
| `HatTracker` | 모자 보유자 산출 시 게스트 제외 |

### 3. RoundMgr 게스트 기능
| 기능 | 설명 |
|------|------|
| 게스트 상태 | `guests` 배열 (tempId, name, target, pairedWith) |
| Step 1 UI | 이름 + 목표타수 입력 + 동반 멤버 선택 드롭다운 |
| 카트배 밸런스 | avg 없는 멤버는 목표타수 기반, 게스트는 입력된 목표타수 기반 |
| 동반 배정 | 지정된 멤버와 같은 카트에 자동 배치, 미지정 게스트는 가장 작은 카트에 |
| Step 2 스코어 | 게스트도 타수 입력 가능 (보라색 표시) |
| 순위 미리보기 | 게스트 포함하되 F1 포인트는 정회원만 부여 |
| 모자 산출 | 꼴찌 판정 시 게스트 제외 |
| Step 3 수상 | 수상자 드롭다운에 게스트도 포함 |
| 저장 | 게스트 → members 테이블에 is_guest=true로 생성 후 실제 ID로 치환하여 저장 |

### 4. 카트배 밸런스 기준 변경
- **기존**: avg가 없으면 100으로 고정
- **변경**: avg가 없으면 해당 멤버의 `target_score`(목표타수) 사용
- 게스트는 추가 시 입력한 목표타수 사용

### 5. 멤버 deselect 시 자동 처리
- 참석자에서 멤버를 제거하면, 해당 멤버와 동반 지정된 게스트의 동반 설정이 자동 해제

## 테스트 방법
1. Supabase에서 `ALTER TABLE` SQL 실행
2. 월례회 관리 → ①참석 탭에서 게스트 추가 섹션 확인
3. 게스트 이름 + 목표타수 입력, 동반 멤버 선택 후 추가
4. 카트배 밸런스 편성 → 게스트가 동반 멤버와 같은 카트에 배정되는지 확인
5. ②스코어 → 게스트 타수 입력, 순위 미리보기에서 게스트 표시 확인
6. ③저장 후 지난 월례회에서 게스트가 👤 표시로 구분되는지 확인
7. 순위표, 출석, 회비, 멤버 목록에 게스트가 나타나지 않는지 확인
